# Read COLVAR file
# RemoVe BANDWIDTHS and substitute with KERNEL=DISCRETE in case one wants DISCRETE kernel.

sf1:   READ FILE=COLVAR  IGNORE_TIME VALUES=sf1
sf2:   READ FILE=COLVAR  IGNORE_TIME VALUES=sf2

chi1:   READ FILE=COLVAR  IGNORE_TIME VALUES=chi1_161
chi2:   READ FILE=COLVAR  IGNORE_TIME VALUES=chi2_161
d1:     READ FILE=COLVAR-driver  IGNORE_TIME VALUES=d4
d3:     READ FILE=COLVAR-driver  IGNORE_TIME VALUES=d3
t3:     READ FILE=COLVAR  IGNORE_TIME VALUES=chi1_166
t4:     READ FILE=COLVAR  IGNORE_TIME VALUES=chi2_166
rms:    READ FILE=rms-achelix-new.xvg  IGNORE_TIME VALUES=rms

metad:       READ FILE=COLVAR IGNORE_TIME VALUES=metad.rbias

# Define weights
weights1: REWEIGHT_METAD TEMP=300 ARG=metad.rbias

# Calculate histograms

HISTOGRAM ...

  ARG=sf1,sf2
  GRID_MIN=-8,-8
  GRID_MAX=8,8
  GRID_BIN=200,200
  BANDWIDTH=0.16,0.25
  LOGWEIGHTS=weights1
  LABEL=hh1

... HISTOGRAM

HISTOGRAM ...

  ARG=chi1,chi2
  GRID_MIN=-pi,-pi
  GRID_MAX=pi,pi
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.03
  LOGWEIGHTS=weights1
  LABEL=hh2

... HISTOGRAM


HISTOGRAM ...

  ARG=t3,d1
  GRID_MIN=-pi,0.2
  GRID_MAX=pi,2.0
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.025
  LOGWEIGHTS=weights1
  LABEL=hh3

... HISTOGRAM

HISTOGRAM ...

  ARG=t3,d3
  GRID_MIN=-pi,0.2
  GRID_MAX=pi,2.4
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.08
  LOGWEIGHTS=weights1
  LABEL=hh4

... HISTOGRAM

HISTOGRAM ...

  ARG=t3,t4
  GRID_MIN=-pi,-pi
  GRID_MAX=pi,pi
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.03
  LOGWEIGHTS=weights1
  LABEL=hh5

... HISTOGRAM

HISTOGRAM ...

  ARG=chi1,d1
  GRID_MIN=-pi,0.2
  GRID_MAX=pi,2.4
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.025
  LOGWEIGHTS=weights1
  LABEL=hh6

... HISTOGRAM

HISTOGRAM ...

  ARG=t3,rms
  GRID_MIN=-pi,0.0
  GRID_MAX=pi,0.4
  GRID_BIN=200,200
  BANDWIDTH=0.03,0.01
  LOGWEIGHTS=weights1
  LABEL=hh7

... HISTOGRAM


# Print histograms to file
ff1: CONVERT_TO_FES GRID=hh1 TEMP=300 MINTOZERO
DUMPGRID GRID=ff1 FILE=fes_sfa.dat
DUMPGRID GRID=hh1 FILE=histo_sfa FMT=%24.16e

ff2: CONVERT_TO_FES GRID=hh2 TEMP=300 MINTOZERO
DUMPGRID GRID=ff2 FILE=fes_phe.dat 
DUMPGRID GRID=hh2 FILE=histo_phe FMT=%24.16e

ff3: CONVERT_TO_FES GRID=hh3 TEMP=300 MINTOZERO
DUMPGRID GRID=ff3 FILE=fes_trparg.dat
DUMPGRID GRID=hh3 FILE=histo_trparg FMT=%24.16e

ff4: CONVERT_TO_FES GRID=hh4 TEMP=300 MINTOZERO
DUMPGRID GRID=ff4 FILE=fes_trpglu.dat
DUMPGRID GRID=hh4 FILE=histo_trpglu FMT=%24.16e

ff5: CONVERT_TO_FES GRID=hh5 TEMP=300 MINTOZERO
DUMPGRID GRID=ff5 FILE=fes_trp.dat
DUMPGRID GRID=hh5 FILE=histo_trp FMT=%24.16e

ff6: CONVERT_TO_FES GRID=hh6 TEMP=300 MINTOZERO
DUMPGRID GRID=ff6 FILE=fes_phearg.dat
DUMPGRID GRID=hh6 FILE=histo_phearg FMT=%24.16e

ff7: CONVERT_TO_FES GRID=hh7 TEMP=300 MINTOZERO
DUMPGRID GRID=ff7 FILE=fes_trprms.dat
DUMPGRID GRID=hh7 FILE=histo_trprms FMT=%24.16e
